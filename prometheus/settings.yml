global:
  scrape_interval: 15s
  evaluation_interval: 15s

scrape_configs:
  # --- base ---
  - job_name: "prometheus"
    static_configs:
      - targets: ["prometheus:9090"]

  - job_name: "node-exporter"
    static_configs:
      - targets: ["node-exporter:9100"]

  - job_name: "cadvisor"
    static_configs:
      - targets: ["cadvisor:8080"]

  # --- infra / db ---
  - job_name: "etcd"
    metrics_path: /metrics
    static_configs:
      - targets: ["etcd:2379"]  # etcd 在 client 端口暴露 /metrics :contentReference[oaicite:9]{index=9}

  - job_name: "postgres"
    static_configs:
      - targets: ["postgres-exporter:9187"]

  - job_name: "redis"
    static_configs:
      - targets: ["redis-exporter:9121"]

  - job_name: "kafka"
    static_configs:
      - targets: ["kafka-exporter:9308"]

  - job_name: "elasticsearch"
    static_configs:
      - targets: ["elasticsearch-exporter:9114"]

  # --- minio (需要 MINIO_PROMETHEUS_AUTH_TYPE=public 才能免 token 抓) :contentReference[oaicite:10]{index=10}
  - job_name: "minio-cluster"
    metrics_path: /minio/v2/metrics/cluster
    static_configs:
      - targets: ["minio:9000"]

  - job_name: "minio-node"
    metrics_path: /minio/v2/metrics/node
    static_configs:
      - targets: ["minio:9000"]

  # --- milvus (官方文档：9091/metrics) :contentReference[oaicite:11]{index=11}
  - job_name: "milvus"
    metrics_path: /metrics
    static_configs:
      - targets: ["milvus-standalone:9091"]

  # --- neo4j (需要启用 server.metrics.prometheus.*，且文档标注 Enterprise) :contentReference[oaicite:12]{index=12}
  - job_name: "neo4j"
    metrics_path: /metrics
    static_configs:
      - targets: ["neo4j:2004"]

  # --- flink (需要配置 PrometheusReporterFactory + port) :contentReference[oaicite:13]{index=13}
  - job_name: "flink-jobmanager"
    metrics_path: /metrics
    static_configs:
      - targets: ["flink-jobmanager:9249"]

  - job_name: "flink-taskmanager"
    metrics_path: /metrics
    static_configs:
      - targets: ["flink-taskmanager:9249"]

  - job_name: "user-rpc"
    static_configs:
      - targets: ["host.docker.internal:9094"]
